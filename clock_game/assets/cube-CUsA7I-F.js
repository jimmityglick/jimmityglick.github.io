import{r as d,a as Z,b as F,c as L,s as D,u as se,T as ae,g as ie,j as e,m as f,P as $,S,B as O,d as b,h as T,f as re,R as ne}from"./styles-DpeE_taN.js";const R=(t,r)=>t*r+r/2,le=({current:t,grid:r,cell:i,stiffness:N=140,damping:a=18})=>{const x=r*i,h=d.useRef({x:t.x,y:t.y}),u=Z(R(t.x,i)),p=Z(R(t.y,i)),k=F(u,{stiffness:N,damping:a}),g=F(p,{stiffness:N,damping:a}),C=L(k,w=>(w%x+x)%x),n=L(g,w=>(w%x+x)%x);return d.useEffect(()=>{const w=D(h.current.x,t.x,r),m=D(h.current.y,t.y,r),M=h.current.x+w,_=h.current.y+m;u.set(R(M,i)),p.set(R(_,i)),h.current={x:(M%r+r)%r,y:(_%r+r)%r}},[i,t.x,t.y,r,u,p]),{wrappedX:C,wrappedY:n}},{grid:c,cell:j,padding:A,storageKey:oe}=ae,o=c*j,ce=`-${A} -${A} ${o+A*2} ${o+A*2}`,E=t=>t.yaw*c+t.pitch,de=t=>({yaw:Math.floor(t/c),pitch:t%c}),xe=(t,r,i)=>{const N=[i[0],[-i[0][0],-i[0][1]],i[1],[-i[1][0],-i[1][1]]],a=Array(c*c).fill(1/0),x=[],h=E(t),u=E(r);for(a[h]=0,x.push(h);x.length;){const p=x.shift();if(p===void 0)break;if(p===u)return a[p];const k=de(p);for(const g of N){const C={yaw:T(k.yaw+g[0]),pitch:T(k.pitch+g[1])},n=E(C);a[n]===1/0&&(a[n]=a[p]+1,x.push(n))}}return 1/0},P=t=>t*j+j/2,he=()=>{const[t,r]=d.useState({yaw:0,pitch:3}),[i,N]=d.useState({yaw:2,pitch:1}),[a,x]=d.useState([[1,0],[0,1]]),[h,u]=d.useState(0),[p,k]=d.useState(null),[g,C]=d.useState(!0),[n,w]=d.useState(!1),[m,M]=d.useState([]),{best:_,updateBestIfBetter:H,resetBest:K}=se(oe),{wrappedX:Y,wrappedY:X}=le({current:{x:t.yaw,y:t.pitch},grid:c,cell:j}),U=d.useMemo(()=>P(i.yaw),[i.yaw]),V=d.useMemo(()=>P(i.pitch),[i.pitch]),q=d.useMemo(()=>Array.from({length:c+1},(s,l)=>({pos:l*j,key:l})),[]),W=d.useCallback(()=>{const s=ie(),l={yaw:Math.floor(Math.random()*c),pitch:Math.floor(Math.random()*c)};let y={yaw:Math.floor(Math.random()*c),pitch:Math.floor(Math.random()*c)};for(;y.yaw===l.yaw&&y.pitch===l.pitch;)y={yaw:Math.floor(Math.random()*c),pitch:Math.floor(Math.random()*c)};x(s),r(l),N(y),u(0),k(()=>{const v=xe(l,y,s);return Number.isFinite(v)?v:null}),M([]),w(!1)},[]);d.useEffect(()=>{W()},[W]);const B=(s,l)=>{if(n)return;const y=[s[0]*l,s[1]*l],v=t,I={yaw:T(t.yaw+y[0]),pitch:T(t.pitch+y[1])},G=h+1;r(I),u(G),M([...m,{from:v,to:I,delta:y}]),I.yaw===i.yaw&&I.pitch===i.pitch&&(w(!0),H(G))},z=()=>{if(n||m.length===0)return;const s=m[m.length-1];M(m.slice(0,-1)),r(s.from),u(Math.max(0,h-1))},J=()=>C(s=>!s),Q=n?"Solved":"Playing",ee=p===null?"--":String(p),te=_===null?"--":String(_);return e.jsx("div",{className:"min-h-screen bg-slate-950 text-slate-100 [background:radial-gradient(1200px_600px_at_10%_5%,rgba(56,76,140,0.35),transparent_60%),radial-gradient(900px_520px_at_90%_0%,rgba(51,65,105,0.4),transparent_55%),linear-gradient(160deg,#0b0f1c,#151a2f)]",children:e.jsxs("div",{className:"mx-auto grid max-w-5xl gap-6 px-6 py-10",children:[e.jsx(f.section,{initial:{opacity:0,y:16},animate:{opacity:1,y:0},transition:{duration:.5},children:e.jsxs($,{className:"grid gap-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx("h1",{className:"font-display text-xl",children:"Pac-Man Map (Flat Torus)"}),e.jsx("p",{className:"text-sm text-slate-300",children:"Yaw = X, Pitch = Y on a 6×6 grid with wraparound edges (like Pac-Man). Moves are vector additions mod 6 on both axes."})]}),e.jsx("a",{href:"./index.html",className:"rounded-full border border-slate-600 bg-slate-800/80 px-4 py-2 text-sm font-semibold text-slate-100 hover:brightness-110",children:"Back to Clock"})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx(S,{label:"Current (yaw, pitch)",value:`${t.yaw}, ${t.pitch}`,minWidthClass:"min-w-[140px]"}),e.jsx(S,{label:"Target",value:g?`${i.yaw}, ${i.pitch}`:"?, ?",minWidthClass:"min-w-[140px]"}),e.jsx(S,{label:"Moves",value:h}),e.jsx(S,{label:"Par",value:ee}),e.jsx(S,{label:"Best",value:te}),e.jsx(S,{label:"Status",value:Q})]})]})}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-[1.2fr_1fr]",children:[e.jsx(f.section,{initial:{opacity:0,y:16},animate:{opacity:1,y:0},transition:{duration:.6,delay:.05},children:e.jsxs($,{children:[e.jsxs("svg",{viewBox:ce,className:"w-full rounded-2xl border border-slate-800/80 bg-slate-950/80",children:[e.jsx("rect",{x:"0",y:"0",width:o,height:o,className:"fill-slate-900/80 stroke-slate-700",strokeWidth:"2"}),q.map(s=>e.jsxs("g",{children:[e.jsx("line",{x1:s.pos,y1:0,x2:s.pos,y2:o,className:"stroke-slate-800",strokeWidth:"1"}),e.jsx("line",{x1:0,y1:s.pos,x2:o,y2:s.pos,className:"stroke-slate-800",strokeWidth:"1"})]},`g-${s.key}`)),Array.from({length:c}).map((s,l)=>Array.from({length:c}).map((y,v)=>e.jsxs("text",{x:P(l),y:P(v),className:"text-[8px] fill-slate-500",textAnchor:"middle",dominantBaseline:"middle",children:[l,",",v]},`cell-${l}-${v}`))),g&&e.jsx(f.rect,{x:U-j/2,y:V-j/2,width:j,height:j,rx:"4",className:"fill-emerald-300/25 stroke-emerald-200",strokeWidth:"1.5",animate:{opacity:[.5,.9,.5]},transition:{repeat:1/0,duration:1.4}}),e.jsx(f.circle,{r:10,className:n?"fill-emerald-200 stroke-emerald-400":"fill-sky-200 stroke-sky-400",strokeWidth:"3",cx:Y,cy:X,animate:{scale:n?[1,1.12,1]:[1,1.04,1]},transition:{repeat:1/0,duration:n?1.2:1.6}}),e.jsxs(f.text,{x:Y,y:X,dy:"-14",textAnchor:"middle",className:"text-[10px] font-semibold text-slate-100 drop-shadow",fill:"currentColor",initial:{opacity:0},animate:{opacity:.9},children:["You (",t.yaw,",",t.pitch,")"]}),n&&e.jsxs(e.Fragment,{children:[e.jsx(f.rect,{x:"-6",y:"-6",width:o+12,height:o+12,className:"fill-transparent stroke-emerald-200",strokeWidth:"3",initial:{opacity:.85},animate:{opacity:1},transition:{duration:.3}}),e.jsx(f.rect,{x:"-8",y:"-8",width:o+16,height:o+16,className:"fill-transparent stroke-emerald-200",strokeWidth:"2.5",animate:{x:[-8,-14],y:[-8,-14],width:[o+16,o+28],height:[o+16,o+28],opacity:[.8,0]},transition:{duration:1,ease:"easeOut",repeat:1/0}}),e.jsx(f.text,{x:o/2,y:o+10,textAnchor:"middle",className:"text-[10px] font-semibold uppercase tracking-[0.4em] text-emerald-100",fill:"currentColor",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.35},children:"Target Hit"})]}),e.jsx("text",{x:-8,y:o+10,className:"text-[10px] fill-slate-400",textAnchor:"start",children:"X wraps →, Y wraps ↑"})]}),e.jsxs("p",{className:"mt-4 text-sm text-slate-300",children:["Flat torus view: moving off an edge wraps to the opposite side instantly (Pac-Man rules). States are vectors (yaw, pitch) in Z",e.jsx("sub",{children:"6"})," × Z",e.jsx("sub",{children:"6"}),"."]})]})}),e.jsx(f.section,{initial:{opacity:0,y:16},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},children:e.jsxs($,{className:"grid gap-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 min-h-[52px]",children:[e.jsx("p",{className:"text-sm text-slate-300",children:"Choose a move vector (Δyaw, Δpitch). Both axes update together. Wraparound keeps every move valid."}),e.jsxs(O,{children:["Mode: ",g?"Reveal Target":"Hidden Target"]})]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 min-h-[52px]",children:[e.jsx("p",{className:"text-sm text-slate-300",children:"Allowed move vectors this round"}),e.jsxs(O,{children:["±(",a[0][0],", ",a[0][1],"), ±(",a[1][0],", ",a[1][1],")"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(b,{onClick:()=>B(a[0],1),disabled:n,children:["+(",a[0][0],", ",a[0][1],")"]}),e.jsxs(b,{variant:"secondary",onClick:()=>B(a[0],-1),disabled:n,children:["-(",a[0][0],", ",a[0][1],")"]}),e.jsxs(b,{onClick:()=>B(a[1],1),disabled:n,children:["+(",a[1][0],", ",a[1][1],")"]}),e.jsxs(b,{variant:"secondary",onClick:()=>B(a[1],-1),disabled:n,children:["-(",a[1][0],", ",a[1][1],")"]}),e.jsx(b,{variant:"secondary",onClick:z,disabled:n||m.length===0,children:"Undo"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(b,{onClick:W,children:"New Round"}),e.jsx(b,{variant:"secondary",onClick:J,children:"Toggle Target Reveal"}),e.jsx(b,{variant:"danger",onClick:K,children:"Reset Best"})]}),e.jsx("div",{className:"max-h-52 overflow-auto rounded-xl border border-slate-800/80 bg-slate-950/80",children:e.jsx("ul",{className:"divide-y divide-slate-800/80 text-sm text-slate-200",children:m.length===0?e.jsx("li",{className:"px-3 py-2 text-slate-400",children:"No moves yet."}):m.slice().reverse().map((s,l)=>{const y=s.delta[0]>0||s.delta[0]===0&&s.delta[1]>0?"+":"";return e.jsxs("li",{className:"flex items-center justify-between gap-3 px-3 py-2",children:[e.jsxs("span",{children:["#",m.length-l,": ",y,"(",s.delta[0],", ",s.delta[1],")"]}),e.jsxs("span",{className:"text-slate-400",children:["(",s.from.yaw,", ",s.from.pitch,") -> (",s.to.yaw,", ",s.to.pitch,")"]})]},`move-${m.length-l}`)})})}),e.jsxs("div",{className:"text-xs text-slate-400",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-slate-200",children:"Scoring:"})," fewer moves is better. Best score is saved in your browser (localStorage)."]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("span",{className:"font-semibold text-slate-200",children:"Group lens:"})," moves add vectors in Z",e.jsx("sub",{children:"6"})," × Z",e.jsx("sub",{children:"6"}),"."]})]})]})})]})]})})};re.createRoot(document.getElementById("cube-root")).render(e.jsx(ne.StrictMode,{children:e.jsx(he,{})}));
